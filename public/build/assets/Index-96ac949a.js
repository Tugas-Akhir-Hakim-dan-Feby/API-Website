import{_ as F,A as N,s as E,r as d,o,c as n,b as m,w as h,d as u,t as w,f as r,a as e,g as b,k as W,v as j,F as p,l as L,j as B,n as V,u as A}from"./app-18f778da.js";import{S as K}from"./Success-1f5d5948.js";import{C as I}from"./Confirm-49494ca7.js";import{P as O}from"./PageTitle-6608e5c7.js";import{P as z}from"./Pagination-c5b31487.js";import{P as q}from"./pagination-8c4016f1.js";import{L as G}from"./Loader-9414f264.js";const J={data(){return{users:[],pagination:{perPage:10,page:1},filters:{search:""},metaPagination:{},msg:"",isDisabled:!1,isLoading:!1,uploadProgress:0,excelFile:null,errorMessage:{}}},computed:{dataExcel(){let s=new FormData;return s.append("file",this.excelFile),s}},mounted(){this.getUsers()},methods:{iteration(s){return q.iteration(s,this.metaPagination)},getUsers(){this.isLoading=!0;let s=[`per_page=${this.pagination.perPage}`,`page=${this.pagination.page}`,`search=${this.filters.search}`].join("&");this.$store.dispatch("getData",["user/welder-member",s]).then(l=>{this.isLoading=!1,this.users=l.data,this.metaPagination=l.meta}).catch(l=>{this.isLoading=!1})},handleDelete(){$("#confirmModal").modal("show")},onDelete(){$("#confirmModal").modal("hide"),$("#successModal").modal("show"),this.msg="data berhasil dihapus."},onUpdateStatus(s,l){$("#successModal").modal("show"),this.msg="status berhasil diperbaharui."},onPageChange(s){this.pagination.page=s,this.getUsers()},onSearch(){setTimeout(()=>{this.getUsers()},1e3)},async handleUploadData(){this.errorMessage={},this.isDisabled=!0;try{N.init(),await E.post("user/welder-member/upload-excel",this.dataExcel,{onUploadProgress:s=>{this.uploadProgress=100}}).then(s=>{this.isDisabled=!1,$("#uploadData").modal("hide"),this.excelFile=null,this.getUsers()})}catch(s){this.isDisabled=!1,console.log(s),s.response.data.status_code==422&&(this.errorMessage=s.response.data),s.response.data.status_code==500&&($("#uploadData").modal("hide"),this.errorMessage=s.response.data)}finally{this.isDisabled=!1,this.excelFile=null,this.uploadProgress=0}},uploadExcelData(s){this.excelFile=s.target.files[0]}},components:{Pagination:z,PageTitle:O,Success:K,Confirm:I,Loader:G}},Q={class:"breadcrumb m-0"},R={class:"breadcrumb-item"},X=e("li",{class:"breadcrumb-item active"}," Daftar Pengguna Welder Member ",-1),Y={key:0,class:"alert alert-danger alert-dismissible text-bg-danger border-0 fade show",role:"alert"},Z=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"alert","aria-label":"Close"},null,-1),ee={class:"card"},se={class:"card-body"},ae={class:"table-responsive"},te={class:"d-md-flex d-block justify-content-between align-items-center mb-2"},oe={key:0,class:"btn btn-primary btn-sm mb-md-0 mb-sm-2","data-bs-toggle":"modal","data-bs-target":"#uploadData"},le={class:"d-md-flex justify-content-between align-items-center"},ne={class:"text-center me-2"},ie={class:"table-responsive"},re={class:"table table-hover table-bordered"},de=e("thead",null,[e("tr",null,[e("th",null,"No."),e("th",null,"No. KTA"),e("th",null,"No. KTP"),e("th",null,"Nama Pengguna"),e("th",null,"Email"),e("th",null,"Keahlian"),e("th",null,"Aksi")])],-1),ce={key:0},me=e("td",{colspan:"7",class:"text-center"}," data welder member tidak ada ",-1),ue=[me],he=["innerHTML"],be=["innerHTML"],pe=["innerHTML"],ge=["innerHTML"],_e=["innerHTML"],fe=["innerHTML"],ye={class:"modal fade",id:"uploadData",tabindex:"-1","aria-labelledby":"uploadDataLabel","aria-hidden":"true","data-bs-backdrop":"static","data-bs-keyboard":"false"},De={class:"modal-dialog"},ve={class:"modal-content"},Me=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"uploadDataLabel"}," Upload Data ")],-1),ke={class:"modal-body"},Pe={key:0,class:"mb-0"},xe=e("label",null,"Masukan file excel",-1),we=["disabled"],Le={key:1,class:"progress"},Te=["aria-valuenow"],Ue={class:"modal-footer d-flex justify-content-between"},Ce=e("a",{href:"/assets/files/sample-data-welder-member.xlsx",target:"_blank"},"Unduh Sampel Format",-1),He=["disabled"],Se={key:0,class:"btn btn-primary"},Fe={key:1,class:"btn btn-primary",type:"button",disabled:""},Ne=e("span",{class:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true"},null,-1);function Ee(s,l,We,je,a,i){var _,f,y,D,v,M;const g=d("router-link"),T=d("PageTitle"),U=d("Loader"),C=d("Pagination"),H=d("Success"),S=d("Confirm");return o(),n(p,null,[m(T,{title:"Daftar Pengguna Welder Member"},{default:h(()=>[e("ol",Q,[e("li",R,[m(g,{to:{name:"Dashboard"}},{default:h(()=>[u("Dashboard")]),_:1})]),X])]),_:1}),a.errorMessage.status_code==500?(o(),n("div",Y,[Z,u(" "+w(a.errorMessage.message),1)])):r("",!0),e("div",ee,[a.isLoading?(o(),b(U,{key:0})):r("",!0),e("div",se,[e("div",ae,[e("div",te,[s.$can("upload-excel","Weldermember")?(o(),n("button",oe," Upload Data ")):r("",!0),e("div",le,[e("div",ne,[s.$can("search","Weldermember")?W((o(),n("input",{key:0,type:"search",class:"form-control",placeholder:"pencarian","onUpdate:modelValue":l[0]||(l[0]=t=>a.filters.search=t),onInput:l[1]||(l[1]=(...t)=>i.onSearch&&i.onSearch(...t))},null,544)),[[j,a.filters.search]]):r("",!0)]),s.$can("pagination","Weldermember")?(o(),b(C,{key:0,pagination:a.metaPagination,onOnPageChange:l[2]||(l[2]=t=>i.onPageChange(t))},null,8,["pagination"])):r("",!0)])])]),e("div",ie,[e("table",re,[de,e("tbody",null,[a.users.length<1?(o(),n("tr",ce,ue)):(o(!0),n(p,{key:1},L(a.users,(t,c)=>{var k,P,x;return o(),n("tr",{key:c},[e("th",{innerHTML:i.iteration(c)},null,8,he),e("td",{innerHTML:t.membershipCard??"-"},null,8,be),e("td",{innerHTML:(k=t.welderMember)==null?void 0:k.residentIdCard},null,8,pe),e("td",{innerHTML:t.name},null,8,ge),e("td",{innerHTML:t.email},null,8,_e),e("td",{innerHTML:(x=(P=t.welderMember)==null?void 0:P.welderSkill)==null?void 0:x.skillName},null,8,fe),e("td",null,[s.$can("show","Weldermember")?(o(),b(g,{key:0,to:{name:"User Member Show",params:{id:t.uuid}},class:"btn btn-sm btn-info me-2"},{default:h(()=>[u("Detail")]),_:2},1032,["to"])):r("",!0)])])}),128))])])])])]),e("div",ye,[e("div",De,[e("div",ve,[Me,e("form",{onSubmit:l[4]||(l[4]=B((...t)=>i.handleUploadData&&i.handleUploadData(...t),["prevent"])),method:"post"},[e("div",ke,[a.uploadProgress<1?(o(),n("div",Pe,[xe,e("input",{type:"file",class:V(["form-control",{"is-invalid":(f=(_=a.errorMessage)==null?void 0:_.messages)==null?void 0:f.file}]),onChange:l[3]||(l[3]=(...t)=>i.uploadExcelData&&i.uploadExcelData(...t)),disabled:a.isDisabled},null,42,we),(D=(y=a.errorMessage)==null?void 0:y.messages)!=null&&D.file?(o(!0),n(p,{key:0},L((M=(v=a.errorMessage)==null?void 0:v.messages)==null?void 0:M.file,(t,c)=>(o(),n("div",{class:"invalid-feedback",key:c},w(t),1))),128)):r("",!0)])):(o(),n("div",Le,[e("div",{class:"progress-bar progress-bar-striped progress-bar-animated",role:"progressbar","aria-valuenow":a.uploadProgress,"aria-valuemin":"0","aria-valuemax":"100",style:A({width:a.uploadProgress+"%"})}," Harap Tunggu! ",12,Te)]))]),e("div",Ue,[Ce,e("div",null,[e("button",{type:"button",class:"btn btn-secondary me-2","data-bs-dismiss":"modal",disabled:a.isDisabled}," Batal ",8,He),a.isDisabled?r("",!0):(o(),n("button",Se," Kirim ")),a.isDisabled?(o(),n("button",Fe,[Ne,u(" Harap Tunggu... ")])):r("",!0)])])],32)])])]),m(H,{url:{name:"User Company"},msg:a.msg},null,8,["msg"]),m(S,{onOnDelete:i.onDelete},null,8,["onOnDelete"])],64)}const qe=F(J,[["render",Ee]]);export{qe as default};
