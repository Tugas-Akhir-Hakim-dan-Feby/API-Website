import{_ as H,A as S,u as F,r as d,o,c as i,b as m,w as u,d as h,t as P,f as r,a as e,g as p,k as N,v as E,F as b,l as x,j,n as B,x as V}from"./app-0b4e2ce8.js";import{S as A}from"./Success-c1d5e79e.js";import{C as O}from"./Confirm-ebc41aee.js";import{P as z}from"./PageTitle-598f0528.js";import{P as I}from"./Pagination-c3b4ca0e.js";import{L as K}from"./Loader-f854f6af.js";import{P as q}from"./pagination-8c4016f1.js";const G={data(){return{uuid:null,users:[],pagination:{perPage:10,page:1},filters:{search:""},metaPagination:{},msg:"",isDisabled:!1,isLoading:!1,uploadProgress:0,excelFile:null,errorMessage:{}}},computed:{dataExcel(){let s=new FormData;return s.append("file",this.excelFile),s}},mounted(){this.getUsers()},methods:{iteration(s){return q.iteration(s,this.metaPagination)},getUsers(){this.isLoading=!0;let s=[`per_page=${this.pagination.perPage}`,`page=${this.pagination.page}`,`search=${this.filters.search}`].join("&");this.$store.dispatch("getData",["user/company-member",s]).then(n=>{this.isLoading=!1,this.users=n.data,this.metaPagination=n.meta}).catch(n=>{this.isLoading=!1})},handleDelete(){$("#confirmModal").modal("show")},onSearch(){setTimeout(()=>{this.getUsers()},1e3)},onDelete(){$("#confirmModal").modal("hide"),$("#successModal").modal("show"),this.msg="data berhasil dihapus."},onPageChange(s){this.pagination.page=s,this.getUsers()},onUpdateStatus(s,n){$("#successModal").modal("show"),this.msg="status berhasil diperbaharui."},async handleUploadData(){this.errorMessage={},this.isDisabled=!0;try{S.init(),await F.post("user/company-member/upload-excel",this.dataExcel,{onUploadProgress:s=>{this.uploadProgress=100}}).then(s=>{this.isDisabled=!1,$("#uploadData").modal("hide"),this.excelFile=null,this.getUsers()})}catch(s){this.isDisabled=!1,s.response.data.status_code==422&&(this.errorMessage=s.response.data),s.response.data.status_code==500&&($("#uploadData").modal("hide"),this.errorMessage=s.response.data)}finally{this.isDisabled=!1,this.excelFile=null,this.uploadProgress=0}},uploadExcelData(s){this.excelFile=s.target.files[0]},onDelete(){this.isLoading=!0,$("#confirmModal").modal("hide"),this.$store.dispatch("deleteData",["user/company-member",this.uuid]).then(s=>{this.getUsers(),this.isLoading=!1,this.msg="data berhasil dihapus.",$("#successModal").modal("show")}).catch(s=>{this.isLoading=!1})},handleDelete(s){this.uuid=s,this.msg="apakah anda yakin data ini akan dihapus?",$("#confirmModal").modal("show")}},components:{Pagination:I,PageTitle:z,Success:A,Confirm:O,Loader:K}},J={class:"breadcrumb m-0"},Q={class:"breadcrumb-item"},R=e("li",{class:"breadcrumb-item active"}," Daftar Pengguna Member Perusahaan ",-1),W={key:0,class:"alert alert-danger alert-dismissible text-bg-danger border-0 fade show",role:"alert"},X=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"alert","aria-label":"Close"},null,-1),Y={class:"card"},Z={class:"card-body"},ee={class:"table-responsive"},se={class:"d-md-flex d-block justify-content-between align-items-center mb-2"},ae={key:0,class:"btn btn-primary btn-sm mb-md-0 mb-sm-2","data-bs-toggle":"modal","data-bs-target":"#uploadData"},te={class:"d-md-flex justify-content-between align-items-center"},oe={class:"text-center me-2"},ne={class:"table-responsive"},ie={class:"table table-hover table-bordered"},le=e("thead",null,[e("tr",null,[e("th",null,"No."),e("th",null,"No. KTA"),e("th",null,"Nama Perusahaan"),e("th",null,"Nama Pengguna"),e("th",null,"Email"),e("th",null,"Aksi")])],-1),re={key:0},de=e("td",{colspan:"6",class:"text-center"}," data perusahaan member tidak ada ",-1),ce=[de],me=["innerHTML"],he=["innerHTML"],ue=["innerHTML"],pe=["innerHTML"],be=["innerHTML"],ge=["onClick"],_e={class:"modal fade",id:"uploadData",tabindex:"-1","aria-labelledby":"uploadDataLabel","aria-hidden":"true","data-bs-backdrop":"static","data-bs-keyboard":"false"},fe={class:"modal-dialog"},ye={class:"modal-content"},De=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"uploadDataLabel"}," Upload Data ")],-1),ve={class:"modal-body"},ke={key:0,class:"mb-0"},Me=e("label",null,"Masukan file excel",-1),Pe=["disabled"],xe={key:1,class:"progress"},Le=["aria-valuenow"],Ce={class:"modal-footer d-flex justify-content-between"},we=e("a",{href:"/assets/files/sample-data-company-member.xlsx",target:"_blank"},"Unduh Sampel Format",-1),Te=["disabled"],Ue={key:0,class:"btn btn-primary"},He={key:1,class:"btn btn-primary",type:"button",disabled:""},Se=e("span",{class:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true"},null,-1);function Fe(s,n,Ne,Ee,a,l){var _,f,y,D,v,k;const g=d("router-link"),L=d("PageTitle"),C=d("Loader"),w=d("Pagination"),T=d("Success"),U=d("Confirm");return o(),i(b,null,[m(L,{title:"Daftar Pengguna Member Perusahaan"},{default:u(()=>[e("ol",J,[e("li",Q,[m(g,{to:{name:"Dashboard"}},{default:u(()=>[h("Dashboard")]),_:1})]),R])]),_:1}),a.errorMessage.status_code==500?(o(),i("div",W,[X,h(" "+P(a.errorMessage.message),1)])):r("",!0),e("div",Y,[a.isLoading?(o(),p(C,{key:0})):r("",!0),e("div",Z,[e("div",ee,[e("div",se,[s.$can("upload-excel","Companymember")?(o(),i("button",ae," Upload Data ")):r("",!0),e("div",te,[e("div",oe,[s.$can("search","Companymember")?N((o(),i("input",{key:0,type:"search",class:"form-control",placeholder:"pencarian","onUpdate:modelValue":n[0]||(n[0]=t=>a.filters.search=t),onInput:n[1]||(n[1]=(...t)=>l.onSearch&&l.onSearch(...t))},null,544)),[[E,a.filters.search]]):r("",!0)]),s.$can("pagination","Companymember")?(o(),p(w,{key:0,pagination:a.metaPagination,onOnPageChange:n[2]||(n[2]=t=>l.onPageChange(t))},null,8,["pagination"])):r("",!0)])])]),e("div",ne,[e("table",ie,[le,e("tbody",null,[a.users.length<1?(o(),i("tr",re,ce)):(o(!0),i(b,{key:1},x(a.users,(t,c)=>{var M;return o(),i("tr",{key:c},[e("th",{innerHTML:l.iteration(c)},null,8,me),e("td",{innerHTML:t.membershipCard??"-"},null,8,he),e("td",{innerHTML:(M=t.companyMember)==null?void 0:M.companyName},null,8,ue),e("td",{innerHTML:t.name},null,8,pe),e("td",{innerHTML:t.email},null,8,be),e("td",null,[s.$can("show","Companymember")?(o(),p(g,{key:0,to:{name:"User Company Show",params:{id:t.uuid}},class:"btn btn-sm btn-info me-2"},{default:u(()=>[h("Detail")]),_:2},1032,["to"])):r("",!0),e("button",{class:"btn btn-sm btn-danger",onClick:je=>l.handleDelete(t.uuid)}," Hapus ",8,ge)])])}),128))])])])])]),e("div",_e,[e("div",fe,[e("div",ye,[De,e("form",{onSubmit:n[4]||(n[4]=j((...t)=>l.handleUploadData&&l.handleUploadData(...t),["prevent"])),method:"post"},[e("div",ve,[a.uploadProgress<1?(o(),i("div",ke,[Me,e("input",{type:"file",class:B(["form-control",{"is-invalid":(f=(_=a.errorMessage)==null?void 0:_.messages)==null?void 0:f.file}]),onChange:n[3]||(n[3]=(...t)=>l.uploadExcelData&&l.uploadExcelData(...t)),disabled:a.isDisabled},null,42,Pe),(D=(y=a.errorMessage)==null?void 0:y.messages)!=null&&D.file?(o(!0),i(b,{key:0},x((k=(v=a.errorMessage)==null?void 0:v.messages)==null?void 0:k.file,(t,c)=>(o(),i("div",{class:"invalid-feedback",key:c},P(t),1))),128)):r("",!0)])):(o(),i("div",xe,[e("div",{class:"progress-bar progress-bar-striped progress-bar-animated",role:"progressbar","aria-valuenow":a.uploadProgress,"aria-valuemin":"0","aria-valuemax":"100",style:V({width:a.uploadProgress+"%"})}," Harap Tunggu! ",12,Le)]))]),e("div",Ce,[we,e("div",null,[e("button",{type:"button",class:"btn btn-secondary me-2","data-bs-dismiss":"modal",disabled:a.isDisabled}," Batal ",8,Te),a.isDisabled?r("",!0):(o(),i("button",Ue," Kirim ")),a.isDisabled?(o(),i("button",He,[Se,h(" Harap Tunggu... ")])):r("",!0)])])],32)])])]),m(T,{url:{name:"User Company"},msg:a.msg},null,8,["msg"]),m(U,{onOnDelete:l.onDelete,msg:a.msg},null,8,["onOnDelete","msg"])],64)}const qe=H(G,[["render",Fe]]);export{qe as default};
