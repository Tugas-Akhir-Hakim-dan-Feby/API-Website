import{L as E}from"./Loader-587f361e.js";import{q as k,_ as C,e as p,i as v,r as K,o as n,c as r,a as e,g as A,f as u,F as g,l as f,n as x,t as b,k as L,p as H,j as O,v as B,d as I,x as V,y as F}from"./app-913bfa44.js";var G=typeof k=="object"&&k&&k.Object===Object&&k,N=G,W=N,q=typeof self=="object"&&self&&self.Object===Object&&self,z=W||q||Function("return this")(),R=z,J=R,Q=J.Symbol,D=Q,T=D;T&&T.toStringTag;var M=D;M&&M.toStringTag;const U={data(){return{uuid:null,isLoading:!1,isOk:!1,currentTime:null,examPacketId:null,examId:null,message:"",exams:{},examAnswer:{},examPacket:{},metaPagination:{},pagination:{perPage:1,page:1},participantAnswer:"",numbering:[],errors:{},form:{keyPacket:""}}},beforeMount(){p.get("examSession")?(setTimeout(()=>{this.examId=this.$route.params.examId,this.examPacketId=this.$route.params.examPacketId,this.getExams(),this.getExamPacket()},1e3),setTimeout(()=>{this.getMinute(this.examPacket.startTime,this.examPacket.endTime)},2e3)):$("#loginExam").modal("show")},mounted(){p.get("examSession")?(this.numbering=localStorage.getItem("numbering"),document.addEventListener("keydown",this.onDisabled),document.addEventListener("visibilitychange",this.onVisibleChange),setTimeout(()=>{this.startTimer()},4e3)):$("#loginExam").modal("show")},watch:{uuid(t){if(t)return t}},methods:{startTimer(){const[t,a]=this.examPacket.endTime.split(":"),l=new Date;l.setHours(t),l.setMinutes(a);const _=setInterval(()=>{const s=new Date;if(s>=l)clearInterval(_),this.currentTime="Waktu telah habis";else{const o=l-s,m=Math.floor(o/(1e3*60*60)),c=Math.floor(o%(1e3*60*60)/(1e3*60)),i=Math.floor(o%(1e3*60)/1e3);this.currentTime=`${this.formatTime(m)}:${this.formatTime(c)}:${this.formatTime(i)}`}},1e3)},formatTime(t){return t<10?`0${t}`:t},handleLogin(){this.errors={},this.isLoading=!0;const t={examPacketId:this.$route.params.examPacketId,keyPacket:this.form.keyPacket};this.$store.dispatch("postData",["user-exam-packet/key-check",t]).then(a=>{this.isLoading=!1,p.set("examSession",!0),window.location.reload(),$("#loginExam").modal("hide")}).catch(a=>{this.isLoading=!1,a.response.data.status=="WARNING"&&a.response.data.statusCode==400?v.error({message:a.response.data.message,position:"topCenter"}):this.errors=a.response.data.messages})},getExamPacket(){this.$store.dispatch("showData",["exam-packet",this.examPacketId]).then(t=>{this.examPacket=t.data}).catch(t=>{})},getExams(){this.isLoading=!0;let t=this.pagination.page;localStorage.getItem("pageStory")?t=localStorage.getItem("pageStory"):t=this.pagination.page;let a=[`exam_packet_id=${this.examPacketId}`,`per_page=${this.pagination.perPage}`,`page=${t}`,"random=true"].join("&");this.$store.dispatch("getData",["exam",a]).then(l=>{this.isLoading=!1,this.exams=l.data,this.metaPagination=l.meta,this.getExam(l.data[0].uuid)}).catch(l=>{this.isLoading=!1})},getExam(t){this.$store.dispatch("showData",["exam",t]).then(a=>{var l;this.isLoading=!1,this.examAnswer=a.data,a.data.welderAnswer&&(this.participantAnswer=(l=a.data.welderAnswer)==null?void 0:l.answer.uuid)}).catch(a=>{this.isLoading=!1})},getMinute(t,a){const[l,_]=t.split(":"),[s,o]=a.split(":"),m=new Date;m.setHours(l),m.setMinutes(_);const c=new Date;c.setHours(s),c.setMinutes(o);let i=(c.getTime()-m.getTime())/1e3/60;i<0&&(i+=1440),this.currentTime=i.toFixed(0)},onPageChange(t,a){this.pagination.page=t,localStorage.setItem("pageStory",t),a?this.handleSubmit():this.getExams()},onDisabled(t){t.preventDefault(),this.isOk=!0,(t.key=="p"&&(t.ctrlKey||t.metaKey)||t.key=="w"&&(t.ctrlKey||t.metaKey)||t.key=="i"&&(t.ctrlKey||t.metaKey)||t.key=="i"&&t.shiftKey&&(t.ctrlKey||t.metaKey)||t.key=="p"&&t.shiftKey&&(t.ctrlKey||t.metaKey))&&(t.preventDefault(),this.handlePenalty("anda melakukan percobaan kombinasi keyboard yang dilarang! <br /> ujian anda dibekukan sementara silahkan hubungi operator."))},onVisibleChange(t){document.visibilityState!="visible"&&(this.isOk=!0,this.handlePenalty("anda melakukan percobaan pindah halaman dari halaman ujian! <br /> ujian anda dibekukan sementara silahkan hubungi operator."))},handleSubmit(){this.isLoading=!0;let t={answerId:this.participantAnswer,examId:this.exams[0].uuid};this.$store.dispatch("postData",["welder-answer",t]).then(a=>{this.isLoading=!1,this.participantAnswer=null,localStorage.setItem("numbering",this.metaPagination.currentPage),this.getExams()}).catch(a=>{this.isLoading=!1,v.error({message:"jawaban harus diisi!",position:"topCenter"})})},handleFinish(){this.isLoading=!0;let t={answerId:this.participantAnswer,examId:this.exams[0].uuid,status:"finish",examPacketId:this.examPacketId};this.$store.dispatch("postData",["welder-answer",t]).then(a=>{this.isLoading=!1,this.participantAnswer=null,localStorage.removeItem("pageStory"),p.remove("examSession"),$("#confirmModal").modal("hide"),window.location.href=`/exam-packet/${this.examPacketId}/success`}).catch(a=>{this.isLoading=!1,v.error({message:"jawaban harus diisi!",position:"topCenter"})})},handlePenalty(t){this.isOk&&(this.message=t,$("#announcmentPenalty").modal("show"))},handleOk(){let t={examPacketId:this.examPacketId};this.$store.dispatch("postData",["user-exam-packet/punishment",t]).then(a=>{localStorage.removeItem("pageStory"),p.remove("examSession"),window.location.href="/exam-packet"}).catch(a=>{})},refreshPage(){this.getExams()},onBack(){$("#loginExam").modal("hide"),window.location.href="/exam-packet"}},components:{Loader:E}},d=t=>(V("data-v-3f8cb3d7"),t=t(),F(),t),X={class:"wrapper"},Y={class:"leftside-menu"},Z={class:"h-100",id:"leftside-menu-container","data-simplebar":""},ee={class:"content-page"},te={class:"content"},ae={class:"navbar-custom"},se={class:"list-unstyled topbar-menu float-end mb-0"},ie={class:"notification-list topbar-dropdown"},ne={href:"#",class:"nav-link",style:{cursor:"default"}},oe={class:"notification-list topbar-dropdown"},re={href:"#",class:"nav-link"},le={class:"notification-list topbar-dropdown"},de={href:"#",class:"nav-link",style:{cursor:"default"}},ce={class:"btn btn-sm btn-success disabled"},me=d(()=>e("button",{class:"button-menu-mobile open-left"},[e("i",{class:"mdi mdi-menu"})],-1)),he={class:"row"},ue={class:"col-12"},be={class:"card"},pe=d(()=>e("div",{class:"card-header"},[e("h4",{class:"card-title"},"Pertanyaan")],-1)),ge={class:"card-body"},_e={class:"card"},ke=d(()=>e("div",{class:"card-header"},[e("h4",{class:"card-title"},"Jawaban")],-1)),fe={class:"card-body"},ye={class:"m-0"},ve=["value","name","checked"],xe={class:"footer bg-white"},Pe={class:"container-fluid"},we={class:"d-flex justify-content-between text-dark"},Se=d(()=>e("h5",null,null,-1)),Le={key:1,style:{cursor:"pointer"},"data-bs-target":"#confirmModal","data-bs-toggle":"modal"},Ie={class:"modal fade",id:"loginExam",tabindex:"-1","aria-labelledby":"loginExamLabel","aria-hidden":"true","data-bs-backdrop":"static","data-bs-keyboard":"false"},Te={class:"modal-dialog modal-dialog-centered"},Me={class:"modal-content"},De=d(()=>e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"loginExamLabel"},"konfirmasi")],-1)),je={class:"modal-body"},Ee=d(()=>e("label",null,"Masukan Kunci Paket",-1)),Ce=["disabled"],Ke={class:"modal-footer"},Ae=["disabled"],He={key:0,class:"btn btn-sm btn-primary"},Oe={key:1,class:"btn btn-sm btn-primary",type:"button",disabled:""},Be=d(()=>e("span",{class:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true"},null,-1)),Ve={class:"modal fade",id:"confirmModal",tabindex:"-1","aria-labelledby":"confirmModalLabel","aria-hidden":"true","data-bs-backdrop":"static","data-bs-keyboard":"false"},Fe={class:"modal-dialog modal-dialog-centered"},Ge={class:"modal-content"},Ne=d(()=>e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"confirmModalLabel"}," konfirmasi ")],-1)),We=d(()=>e("div",{class:"modal-body",innerHTML:"harap periksa kembali jawaban anda, jika sudah yakin bisa klik tombol Simpan?"},null,-1)),qe={class:"modal-footer"},ze=d(()=>e("button",{type:"button",class:"btn btn-sm btn-secondary","data-bs-dismiss":"modal"}," Batal ",-1)),Re={key:1,class:"btn btn-sm btn-primary",type:"button",disabled:""},Je=d(()=>e("span",{class:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true"},null,-1)),Qe={class:"modal fade",id:"announcmentPenalty",tabindex:"-1","aria-labelledby":"announcmentPenaltyLabel","aria-hidden":"true","data-bs-backdrop":"static","data-bs-keyboard":"false"},Ue={class:"modal-dialog modal-dialog-centered"},Xe={class:"modal-content"},Ye=d(()=>e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"announcmentPenaltyLabel"}," Pemberitahuan ")],-1)),Ze={class:"modal-body"},$e=["innerHTML"],et={class:"modal-footer"};function tt(t,a,l,_,s,o){var c;const m=K("Loader");return n(),r(g,null,[e("div",X,[s.isLoading?(n(),A(m,{key:0})):u("",!0),e("div",Y,[e("div",Z,[e("ul",null,[(n(!0),r(g,null,f(s.metaPagination.total,(i,h)=>(n(),r("li",{key:h,class:x({active:s.metaPagination.currentPage==h+1})},b(h+1),3))),128))])])]),e("div",ee,[e("div",te,[e("div",ae,[e("ul",se,[e("li",ie,[e("a",ne,[e("span",{class:x(["btn btn-sm text-white disabled",s.examPacket.examPacketHasWelder?s.examPacket.examPacketHasWelder.penalty>2?"btn-warning":"btn-danger":""])},"Sisa Percobaan "+b((c=s.examPacket.examPacketHasWelder)==null?void 0:c.penalty),3)])]),e("li",oe,[e("a",re,[e("button",{class:"btn btn-sm btn-primary mdi mdi-autorenew",onClick:a[0]||(a[0]=(...i)=>o.refreshPage&&o.refreshPage(...i))})])]),e("li",le,[e("a",de,[e("span",ce,b(s.currentTime),1)])])]),me]),(n(!0),r(g,null,f(s.exams,(i,h)=>(n(),r("div",{class:"container-fluid mt-3",id:"contentQuestion",key:h},[e("div",he,[e("div",ue,[e("div",be,[pe,e("div",ge,[e("p",null,b(i.question),1)])]),e("div",_e,[ke,e("div",fe,[e("ul",null,[(n(!0),r(g,null,f(i.answers,(y,P)=>{var w,S;return n(),r("li",{key:P,class:"shadow-sm d-flex align-items-center justify-content-between"},[e("p",ye,b(y.answer==1?"Benar":"Salah"),1),L(e("input",{type:"radio",value:y.uuid,name:`answer_${P}`,checked:y.uuid==((S=(w=s.examAnswer.welderAnswer)==null?void 0:w.answer)==null?void 0:S.uuid),"onUpdate:modelValue":a[1]||(a[1]=j=>s.participantAnswer=j)},null,8,ve),[[H,s.participantAnswer]])])}),128))])])])])])]))),128))])])]),e("footer",xe,[e("div",Pe,[e("div",we,[e("h5",null,[s.metaPagination.currentPage!=1?(n(),r("span",{key:0,style:{cursor:"pointer"},onClick:a[2]||(a[2]=i=>o.onPageChange(s.metaPagination.currentPage-1,!1))},"Kembali")):u("",!0)]),Se,e("h5",null,[s.metaPagination.currentPage!=s.metaPagination.lastPage?(n(),r("span",{key:0,onClick:a[3]||(a[3]=i=>o.onPageChange(s.metaPagination.currentPage+1,!0)),style:{cursor:"pointer"}},"Selanjutnya")):(n(),r("span",Le,"Selesai"))])])])]),e("div",Ie,[e("div",Te,[e("div",Me,[De,e("form",{onSubmit:a[6]||(a[6]=O((...i)=>o.handleLogin&&o.handleLogin(...i),["prevent"])),method:"post"},[e("div",je,[e("div",null,[Ee,L(e("input",{type:"password",class:x(["form-control",{"is-invalid":s.errors.keyPacket}]),"onUpdate:modelValue":a[4]||(a[4]=i=>s.form.keyPacket=i),disabled:s.isLoading},null,10,Ce),[[B,s.form.keyPacket]]),s.errors.keyPacket?(n(!0),r(g,{key:0},f(s.errors.keyPacket,(i,h)=>(n(),r("div",{class:"invalid-feedback",key:h},b(i),1))),128)):u("",!0)])]),e("div",Ke,[e("button",{type:"button",class:"btn btn-sm btn-secondary",onClick:a[5]||(a[5]=(...i)=>o.onBack&&o.onBack(...i)),disabled:s.isLoading}," Kembali ",8,Ae),s.isLoading?u("",!0):(n(),r("button",He," Kirim ")),s.isLoading?(n(),r("button",Oe,[Be,I(" Harap Tunggu... ")])):u("",!0)])],32)])])]),e("div",Ve,[e("div",Fe,[e("div",Ge,[Ne,We,e("div",qe,[ze,s.isLoading?u("",!0):(n(),r("button",{key:0,type:"button",class:"btn btn-sm btn-primary",onClick:a[7]||(a[7]=i=>o.handleFinish())}," Simpan ")),s.isLoading?(n(),r("button",Re,[Je,I(" Harap Tunggu... ")])):u("",!0)])])])]),e("div",Qe,[e("div",Ue,[e("div",Xe,[Ye,e("div",Ze,[e("p",{innerHTML:s.message},null,8,$e)]),e("div",et,[e("button",{type:"button",class:"btn btn-sm btn-primary","data-bs-dismiss":"modal",onClick:a[8]||(a[8]=i=>(s.isOk=!1,o.handleOk()))}," Tutup ")])])])])],64)}const it=C(U,[["render",tt],["__scopeId","data-v-3f8cb3d7"]]);export{it as default};
