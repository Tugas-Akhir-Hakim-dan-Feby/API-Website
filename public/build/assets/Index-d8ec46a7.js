import{P as J}from"./PageTitle-bd1d27ae.js";import{P as X}from"./Pagination-c41dd9f4.js";import{S as q}from"./Success-26290fb4.js";import{C as z}from"./Confirm-c2993bb2.js";import{L as G}from"./Loader-ad1fe890.js";import{P as Q}from"./pagination-8c4016f1.js";import{d as k}from"./id-06e6ce1c.js";import{_ as v,r as m,o as n,c as l,b as f,w as _,a as t,d as b,g as p,f as d,F as D,l as Z,t as ee}from"./app-dfbfb837.js";const te={data(){return{examPackets:[],errors:{},pagination:{perPage:10,page:1},filters:{search:""},metaPagination:{},roles:[],msg:"",uuid:null,isLoading:!1,isError:!1}},mounted(){this.getExamPackets(),this.getUser()},methods:{iteration(e){return Q.iteration(e,this.metaPagination)},getUser(){this.$store.dispatch("showData",["user","me"]).then(e=>{this.roles=e.roles}).catch(e=>{})},getExamPackets(){this.isLoading=!0;let e=[`per_page=${this.pagination.perPage}`,`page=${this.pagination.page}`,`search=${this.filters.search}`];e.push(["sort_direction=desc"]),this.$store.dispatch("getData",["exam-packet",e.join("&")]).then(a=>{this.isLoading=!1,this.examPackets=a.data,this.metaPagination=a.meta}).catch(a=>{this.isLoading=!1,console.log(a)})},getSchedule(e){return k(e).locale("id").format("DD MMMM YYYY")},getMinute(e,a){const[i,u]=e.split(":"),[r,o]=a.split(":"),c=new Date;c.setHours(i),c.setMinutes(u);const g=new Date;g.setHours(r),g.setMinutes(o);let h=(g.getTime()-c.getTime())/1e3/60;return h<0&&(h+=1440),h.toFixed(0)},handleDelete(e){this.uuid=e,$("#confirmModal").modal("show")},onUpdateStatus(e,a){this.isLoading=!0,this.errors={},this.$store.dispatch("updateData",["exam-packet/update-status",e,{}]).then(i=>{this.isLoading=!1,this.msg="data berhasil diperbaharui.",this.getExamPackets(),$("#successModal").modal("show")}).catch(i=>{this.isLoading=!1,i.response.data.status=="ERROR"&&i.response.data.statusCode==500&&(this.isError=!0,this.msg=i.response.data.message)})},onPageChange(e){this.pagination.page=e,this.getExamPackets()},onDelete(){this.$store.dispatch("deleteData",["exam-packet",this.uuid]).then(e=>{$("#confirmModal").modal("hide"),$("#successModal").modal("show"),this.msg="data berhasil dihapus.",this.getExamPackets()}).catch(e=>{console.log(e)})},checkRole(e){return!!this.roles.includes(e)},checkSchedule(e,a){let i=k();e=k(e).locale("id");let u=i.hour()+":"+i.minute();return!!(a[1]<=u&&u>=a[0]&&i.isSame(e,"day"))}},components:{PageTitle:J,Success:q,Pagination:X,Confirm:z,Loader:G}},se={class:"breadcrumb m-0"},ae={class:"breadcrumb-item"},ne=t("li",{class:"breadcrumb-item active"}," Kumpulan Paket Uji Kompetensi ",-1),ie={class:"card position-relative"},oe={class:"card-body"},re={class:"d-md-flex d-block justify-content-between align-items-center mb-2"},ce={class:"text-center"},le={class:"d-md-flex justify-content-between align-items-center"},de={class:"table-responsive"},ue={class:"table table-hover table-bordered"},he=t("thead",null,[t("tr",null,[t("th",null,"No."),t("th",null,"Nama Paket"),t("th",null,"Jadwal Ujian"),t("th",null,"Tenggat Ujian"),t("th",null,"Jumlah Peserta"),t("th",null,"Aksi")])],-1),me={key:0},ge=t("td",{colspan:"6",class:"text-center"}," data paket uji kompetensi tidak ada ",-1),pe=[ge],_e=["innerHTML"],ke=["innerHTML"],fe=["innerHTML"],be=["innerHTML"],Pe=["onClick"];function $e(e,a,i,u,r,o){const c=m("router-link"),g=m("PageTitle"),h=m("Loader"),L=m("Pagination"),x=m("Success"),S=m("Confirm");return n(),l(D,null,[f(g,{title:"Kumpulan Paket Uji Kompetensi"},{default:_(()=>[t("ol",se,[t("li",ae,[f(c,{to:{name:"Dashboard"}},{default:_(()=>[b("Dashboard")]),_:1})]),ne])]),_:1}),t("div",ie,[r.isLoading?(n(),p(h,{key:0})):d("",!0),t("div",oe,[t("div",re,[t("div",ce,[e.$can("create","Exampacket")?(n(),p(c,{key:0,to:{name:"Exam Packet Create"},class:"btn btn-sm btn-primary mb-2 me-3"},{default:_(()=>[b(" Tambah Paket ")]),_:1})):d("",!0)]),t("div",le,[e.$can("pagination","Exampacket")?(n(),p(L,{key:0,pagination:r.metaPagination,onOnPageChange:a[0]||(a[0]=s=>o.onPageChange(s))},null,8,["pagination"])):d("",!0)])]),t("div",de,[t("table",ue,[he,t("tbody",null,[r.examPackets.length<1?(n(),l("tr",me,pe)):(n(!0),l(D,{key:1},Z(r.examPackets,(s,M)=>{var y;return n(),l("tr",{key:M},[t("th",{innerHTML:o.iteration(M)},null,8,_e),t("td",{innerHTML:s.name},null,8,ke),t("td",{innerHTML:o.getSchedule(s.schedule)},null,8,fe),t("td",{innerHTML:`${s.startTime} - ${s.endTime} WIB <br> (${o.getMinute(s.startTime,s.endTime)} Menit)`},null,8,be),t("td",null,[f(c,{to:{name:"Exam Packet Participant",params:{id:s.uuid}},class:"badge btn-success"},{default:_(()=>{var P;return[b(ee((P=s.examPacketHasWelders)==null?void 0:P.length)+" Peserta ",1)]}),_:2},1032,["to"])]),t("td",null,[e.$can("show","Exampacket")?(n(),p(c,{key:0,to:{name:"Exam Packet Detail",params:{id:s.uuid}},class:"btn btn-info btn-sm me-2 text-white"},{default:_(()=>[b(" Detail ")]),_:2},1032,["to"])):d("",!0),((y=s.user)==null?void 0:y.name)==e.$store.state.USER.uuid||o.checkRole(e.$store.state.ADMIN_APP)||o.checkRole(e.$store.state.ADMIN_HUB)?(n(),l("button",{key:1,class:"btn btn-danger btn-sm",onClick:P=>o.handleDelete(s.uuid)}," Hapus ",8,Pe)):d("",!0)])])}),128))])])])])]),f(x,{msg:r.msg},null,8,["msg"]),f(S,{onOnDelete:o.onDelete},null,8,["onOnDelete"])],64)}const Me=v(te,[["render",$e]]),ye={data(){return{welderHasExamPackets:[],errors:{},pagination:{perPage:10,page:1},filters:{search:""},metaPagination:{},roles:[],msg:"",uuid:null,isLoading:!1,isError:!1,isSchedule:!1,isAfterSchedule:!1}},mounted(){this.getwelderHasExamPackets(),this.getUser()},methods:{iteration(e){return Q.iteration(e,this.metaPagination)},getUser(){this.$store.dispatch("showData",["user","me"]).then(e=>{this.roles=e.roles}).catch(e=>{})},getwelderHasExamPackets(){this.isLoading=!0;let e=[`per_page=${this.pagination.perPage}`,`page=${this.pagination.page}`,`search=${this.filters.search}`];e.push(["sort_direction=desc"]),this.$store.dispatch("getData",["user-exam-packet",e.join("&")]).then(a=>{this.isLoading=!1,this.welderHasExamPackets=a.data,this.metaPagination=a.meta}).catch(a=>{this.isLoading=!1,console.log(a)})},getSchedule(e){return k(e).locale("id").format("DD MMMM YYYY")},getMinute(e,a){const[i,u]=e.split(":"),[r,o]=a.split(":"),c=new Date;c.setHours(i),c.setMinutes(u);const g=new Date;g.setHours(r),g.setMinutes(o);let h=(g.getTime()-c.getTime())/1e3/60;return h<0&&(h+=1440),h.toFixed(0)},handleDelete(e){this.uuid=e,$("#confirmModal").modal("show")},onUpdateStatus(e,a){this.isLoading=!0,this.errors={},this.$store.dispatch("updateData",["exam-packet/update-status",e,{}]).then(i=>{this.isLoading=!1,this.msg="data berhasil diperbaharui.",this.getwelderHasExamPackets(),$("#successModal").modal("show")}).catch(i=>{this.isLoading=!1,i.response.data.status=="ERROR"&&i.response.data.statusCode==500&&(this.isError=!0,this.msg=i.response.data.message)})},onPageChange(e){this.pagination.page=e,this.getwelderHasExamPackets()},onDelete(){this.$store.dispatch("deleteData",["exam-packet",this.uuid]).then(e=>{$("#confirmModal").modal("hide"),$("#successModal").modal("show"),this.msg="data berhasil dihapus.",this.getwelderHasExamPackets()}).catch(e=>{console.log(e)})},checkRoleWelderMember(e){return!!this.roles.includes(e)},checkSchedule(e,a){let i=k();e=k(e).locale("id");let u=i.format("HH:mm");return u>=a[0]&&u<=a[1]&&i.isSame(e,"day")?(this.isSchedule=!0,!0):(this.isSchedule=!1,!1)},checkAfterSchedule(e,a){let i=k();e=k(e).locale("id");let u=i.format("HH:mm");return(i.isSame(e,"day")||e.diff(i)>0)&&u>=a?(this.isAfterSchedule=!0,!0):(this.isAfterSchedule=!1,!1)}},components:{PageTitle:J,Success:q,Pagination:X,Confirm:z,Loader:G}},Te={class:"card position-relative"},De={class:"card-body"},Le={class:"d-md-flex d-block justify-content-between align-items-center mb-2"},xe={class:"text-center"},Se={class:"d-md-flex justify-content-between align-items-center"},Ce={class:"table-responsive"},ve={class:"table table-hover table-bordered"},Ee=t("th",null,"No.",-1),He=t("th",null,"Nama Paket",-1),we=t("th",null,"Jadwal Ujian",-1),Ue=t("th",null,"Tenggat Ujian",-1),Ae={key:0},je={key:1},Re=["innerHTML"],Ne=["innerHTML"],We=["innerHTML"],Be=["innerHTML"],Ie={key:0},Oe={class:"form-check form-switch"},Ye=["checked","onClick"],Ke={key:1},Fe=["onClick"],Ve={key:2},Je=["href"],Xe={key:2};function qe(e,a,i,u,r,o){const c=m("PageTitle"),g=m("Loader"),h=m("router-link"),L=m("Pagination"),x=m("Success"),S=m("Confirm");return n(),l(D,null,[f(c,{title:"Kumpulan Paket Pertanyaan"}),t("div",Te,[r.isLoading?(n(),p(g,{key:0})):d("",!0),t("div",De,[t("div",Le,[t("div",xe,[e.$can("create","Exampacket")?(n(),p(h,{key:0,to:{name:"Exam Packet Create"},class:"btn btn-sm btn-primary mb-2 me-3"},{default:_(()=>[b(" Tambah Paket ")]),_:1})):d("",!0),e.$can("register-packet","Exampacket")?(n(),p(h,{key:1,to:{name:"Exam Packet Register"},class:"btn btn-sm btn-primary mb-2 me-3"},{default:_(()=>[b(" Daftar Uji Kompetensi ")]),_:1})):d("",!0)]),t("div",Se,[e.$can("pagination","Exampacket")?(n(),p(L,{key:0,pagination:r.metaPagination,onOnPageChange:a[0]||(a[0]=s=>o.onPageChange(s))},null,8,["pagination"])):d("",!0)])]),t("div",Ce,[t("table",ve,[t("thead",null,[t("tr",null,[Ee,He,we,Ue,e.$can("update-status","Exampacket")?(n(),l("th",Ae," Status ")):d("",!0),r.isSchedule||r.isAfterSchedule?(n(),l("th",je,"Aksi")):d("",!0)])]),t("tbody",null,[(n(!0),l(D,null,Z(r.welderHasExamPackets,(s,M)=>{var y,P,E,H,w,U,A,j,R,N,W,B,I,O,Y,K,F;return n(),l("tr",{key:M},[t("th",{innerHTML:o.iteration(M)},null,8,Re),t("td",{innerHTML:(y=s.examPacket)==null?void 0:y.name},null,8,Ne),t("td",{innerHTML:o.getSchedule((P=s.examPacket)==null?void 0:P.schedule)},null,8,We),t("td",{innerHTML:`${(E=s.examPacket)==null?void 0:E.startTime} - ${(H=s.examPacket)==null?void 0:H.endTime} WIB (${o.getMinute((w=s.examPacket)==null?void 0:w.startTime,(U=s.examPacket)==null?void 0:U.endTime)} Menit)`},null,8,Be),e.$can("update-status","Exampacket")?(n(),l("td",Ie,[t("div",Oe,[t("input",{class:"form-check-input",type:"checkbox",role:"switch",style:{cursor:"pointer"},checked:(A=s.examPacket)==null?void 0:A.status,onClick:C=>{var T,V;return o.onUpdateStatus((T=s.examPacket)==null?void 0:T.uuid,(V=s.examPacket)==null?void 0:V.status)}},null,8,Ye)])])):d("",!0),o.checkRoleWelderMember(e.$store.state.ADMIN_APP)||o.checkRoleWelderMember(e.$store.state.EXPERT)||o.checkRoleWelderMember(e.$store.state.ADMIN_HUB)?(n(),l("td",Ke,[e.$can("show","Exampacket")?(n(),p(h,{key:0,to:{name:"Exam Packet Detail",params:{id:(j=s.examPacket)==null?void 0:j.uuid}},class:"btn btn-info btn-sm me-2 text-white"},{default:_(()=>[b(" Detail ")]),_:2},1032,["to"])):d("",!0),e.$can("delete","Exampacket")?(n(),l("button",{key:1,class:"btn btn-danger btn-sm",onClick:C=>{var T;return o.handleDelete((T=s.examPacket)==null?void 0:T.uuid)}}," Hapus ",8,Fe)):d("",!0)])):(n(),l("td",Ve,[o.checkSchedule((R=s.examPacket)==null?void 0:R.schedule,[(N=s.examPacket)==null?void 0:N.startTime,(W=s.examPacket)==null?void 0:W.endTime])?(n(),l("a",{key:0,href:`/attempt/${(B=s.examPacket)==null?void 0:B.uuid}/execution/${(O=(I=s.examPacket)==null?void 0:I.exam)==null?void 0:O.uuid}`,onClick:a[1]||(a[1]=(...C)=>e.reloadPage&&e.reloadPage(...C)),class:"btn btn-primary btn-sm"},"Kerjakan",8,Je)):o.checkAfterSchedule((Y=s.examPacket)==null?void 0:Y.schedule,(K=s.examPacket)==null?void 0:K.endTime)?(n(),p(h,{key:1,to:{name:"Exam Packet Success",params:{examPacketId:(F=s.examPacket)==null?void 0:F.uuid}},class:"btn btn-sm btn-info"},{default:_(()=>[b("Lihat Hasil")]),_:2},1032,["to"])):(n(),l("p",Xe,"-"))]))])}),128))])])])])]),f(x,{msg:r.msg},null,8,["msg"]),f(S,{onOnDelete:o.onDelete},null,8,["onOnDelete"])],64)}const ze=v(ye,[["render",qe]]),Ge={components:{Admin:Me,Welder:ze}};function Qe(e,a,i,u,r,o){const c=m("Admin"),g=m("Welder");return e.$can("dashboard-admin","Exampacket")?(n(),p(c,{key:0})):e.$can("dashboard-member","Exampacket")?(n(),p(g,{key:1})):d("",!0)}const rt=v(Ge,[["render",Qe]]);export{rt as default};
