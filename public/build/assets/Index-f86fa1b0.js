import{_ as F,A as E,s as W,r as c,o as l,c as o,b as u,w as b,d as h,t as x,f as r,a as e,g as p,k as L,m as I,F as m,l as g,v as V,j,n as B,u as K}from"./app-b13587b6.js";import{S as A}from"./Success-b38bdeac.js";import{C as O}from"./Confirm-e832016f.js";import{P as z}from"./PageTitle-bf731e9e.js";import{P as q}from"./Pagination-7f594eae.js";import{P as G}from"./pagination-8c4016f1.js";import{L as J}from"./Loader-b2538e61.js";const Q={data(){return{uuid:null,users:[],pagination:{perPage:10,page:1},filters:{search:"",welderSkillId:""},metaPagination:{},welderSkills:[],msg:"",isDisabled:!1,isLoading:!1,uploadProgress:0,excelFile:null,errorMessage:{}}},computed:{dataExcel(){let s=new FormData;return s.append("file",this.excelFile),s}},mounted(){this.getUsers(),this.getWelderSkills()},methods:{iteration(s){return G.iteration(s,this.metaPagination)},getWelderSkills(){this.$store.dispatch("getData",["skill/welder",""]).then(s=>{this.welderSkills=s.data}).catch(s=>{})},getUsers(){this.isLoading=!0;let s=[`per_page=${this.pagination.perPage}`,`page=${this.pagination.page}`,`search=${this.filters.search}`,`welder_skill_id=${this.filters.welderSkillId}`].join("&");this.$store.dispatch("getData",["user/welder-member",s]).then(i=>{this.isLoading=!1,this.users=i.data,this.metaPagination=i.meta}).catch(i=>{this.isLoading=!1})},handleDelete(){$("#confirmModal").modal("show")},onDelete(){$("#confirmModal").modal("hide"),$("#successModal").modal("show"),this.msg="data berhasil dihapus."},onUpdateStatus(s,i){$("#successModal").modal("show"),this.msg="status berhasil diperbaharui."},onPageChange(s){this.pagination.page=s,this.getUsers()},onSearch(){setTimeout(()=>{this.getUsers()},1e3)},onSkillChange(){setTimeout(()=>{this.getUsers()},1e3)},async handleUploadData(){this.errorMessage={},this.isDisabled=!0;try{E.init(),await W.post("user/welder-member/upload-excel",this.dataExcel,{onUploadProgress:s=>{this.uploadProgress=100}}).then(s=>{this.isDisabled=!1,$("#uploadData").modal("hide"),this.excelFile=null,this.getUsers()})}catch(s){this.isDisabled=!1,console.log(s),s.response.data.status_code==422&&(this.errorMessage=s.response.data),s.response.data.status_code==500&&($("#uploadData").modal("hide"),this.errorMessage=s.response.data)}finally{this.isDisabled=!1,this.excelFile=null,this.uploadProgress=0}},uploadExcelData(s){this.excelFile=s.target.files[0]},onDelete(){this.isLoading=!0,$("#confirmModal").modal("hide"),this.$store.dispatch("deleteData",["user/welder-member",this.uuid]).then(s=>{this.getUsers(),this.isLoading=!1,this.msg="data berhasil dihapus.",$("#successModal").modal("show")}).catch(s=>{this.isLoading=!1})},handleDelete(s){this.uuid=s,this.msg="apakah anda yakin data ini akan dihapus?",$("#confirmModal").modal("show")}},components:{Pagination:q,PageTitle:z,Success:A,Confirm:O,Loader:J}},R={class:"breadcrumb m-0"},X={class:"breadcrumb-item"},Y=e("li",{class:"breadcrumb-item active"}," Daftar Pengguna Welder Member ",-1),Z={key:0,class:"alert alert-danger alert-dismissible text-bg-danger border-0 fade show",role:"alert"},ee=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"alert","aria-label":"Close"},null,-1),se={class:"card"},te={class:"card-body"},ae={class:"table-responsive"},le={class:"d-md-flex d-block justify-content-between align-items-center mb-2"},ie={key:0,class:"btn btn-primary btn-sm mb-md-0 mb-sm-2","data-bs-toggle":"modal","data-bs-target":"#uploadData"},oe={class:"d-md-flex justify-content-between align-items-center"},ne={class:"text-center mx-0 mx-sm-2 my-sm-0 my-3"},re=e("option",{value:"",selected:""}," Pilih Keahlian ",-1),de=["value","innerHTML"],ce={class:"text-center me-0 me-sm-2"},me={class:"table-responsive"},ue={class:"table table-hover table-bordered"},he=e("thead",null,[e("tr",null,[e("th",null,"No."),e("th",null,"No. KTA"),e("th",null,"No. KTP"),e("th",null,"Nama Pengguna"),e("th",null,"Email"),e("th",null,"Keahlian"),e("th",null,"Aksi")])],-1),ge={key:0},be=e("td",{colspan:"7",class:"text-center"}," data welder member tidak ada ",-1),pe=[be],_e=["innerHTML"],fe=["innerHTML"],ke=["innerHTML"],ye=["innerHTML"],De=["innerHTML"],ve=["innerHTML"],Me=["onClick"],we={class:"modal fade",id:"uploadData",tabindex:"-1","aria-labelledby":"uploadDataLabel","aria-hidden":"true","data-bs-backdrop":"static","data-bs-keyboard":"false"},Pe={class:"modal-dialog"},xe={class:"modal-content"},Le=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"uploadDataLabel"}," Upload Data ")],-1),Se={class:"modal-body"},Te={key:0,class:"mb-0"},Ce=e("label",null,"Masukan file excel",-1),Ue=["disabled"],He={key:1,class:"progress"},Ne=["aria-valuenow"],Fe={class:"modal-footer d-flex justify-content-between"},Ee=e("a",{href:"/assets/files/sample-data-welder-member.xlsx",target:"_blank"},"Unduh Sampel Format",-1),We=["disabled"],Ie={key:0,class:"btn btn-primary"},Ve={key:1,class:"btn btn-primary",type:"button",disabled:""},je=e("span",{class:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true"},null,-1);function Be(s,i,Ke,Ae,a,n){var f,k,y,D,v,M;const _=c("router-link"),S=c("PageTitle"),T=c("Loader"),C=c("Pagination"),U=c("Success"),H=c("Confirm");return l(),o(m,null,[u(S,{title:"Daftar Pengguna Welder Member"},{default:b(()=>[e("ol",R,[e("li",X,[u(_,{to:{name:"Dashboard"}},{default:b(()=>[h("Dashboard")]),_:1})]),Y])]),_:1}),a.errorMessage.status_code==500?(l(),o("div",Z,[ee,h(" "+x(a.errorMessage.message),1)])):r("",!0),e("div",se,[a.isLoading?(l(),p(T,{key:0})):r("",!0),e("div",te,[e("div",ae,[e("div",le,[s.$can("upload-excel","Weldermember")?(l(),o("button",ie," Upload Data ")):r("",!0),e("div",oe,[e("div",ne,[L(e("select",{class:"form-select","onUpdate:modelValue":i[0]||(i[0]=t=>a.filters.welderSkillId=t),onChange:i[1]||(i[1]=(...t)=>n.onSkillChange&&n.onSkillChange(...t))},[re,(l(!0),o(m,null,g(a.welderSkills,(t,d)=>(l(),o("option",{key:d,value:t.uuid,innerHTML:t.skillName},null,8,de))),128))],544),[[I,a.filters.welderSkillId]])]),e("div",ce,[s.$can("search","Weldermember")?L((l(),o("input",{key:0,type:"search",class:"form-control",placeholder:"Pencarian","onUpdate:modelValue":i[2]||(i[2]=t=>a.filters.search=t),onInput:i[3]||(i[3]=(...t)=>n.onSearch&&n.onSearch(...t))},null,544)),[[V,a.filters.search]]):r("",!0)]),s.$can("pagination","Weldermember")?(l(),p(C,{key:0,pagination:a.metaPagination,onOnPageChange:i[4]||(i[4]=t=>n.onPageChange(t))},null,8,["pagination"])):r("",!0)])])]),e("div",me,[e("table",ue,[he,e("tbody",null,[a.users.length<1?(l(),o("tr",ge,pe)):(l(!0),o(m,{key:1},g(a.users,(t,d)=>{var w;return l(),o("tr",{key:d},[e("th",{innerHTML:n.iteration(d)},null,8,_e),e("td",{innerHTML:t.membershipCard??"-"},null,8,fe),e("td",{innerHTML:(w=t.welderMember)==null?void 0:w.residentIdCard},null,8,ke),e("td",{innerHTML:t.name},null,8,ye),e("td",{innerHTML:t.email},null,8,De),e("td",null,[e("ul",null,[(l(!0),o(m,null,g(t.welderHasSkills,(P,N)=>(l(),o("li",{key:N,innerHTML:P.welderSkill.skillName},null,8,ve))),128))])]),e("td",null,[s.$can("show","Weldermember")?(l(),p(_,{key:0,to:{name:"User Member Show",params:{id:t.uuid}},class:"btn btn-sm btn-info me-2"},{default:b(()=>[h("Detail")]),_:2},1032,["to"])):r("",!0),e("button",{class:"btn btn-sm btn-danger",onClick:P=>n.handleDelete(t.uuid)}," Hapus ",8,Me)])])}),128))])])])])]),e("div",we,[e("div",Pe,[e("div",xe,[Le,e("form",{onSubmit:i[6]||(i[6]=j((...t)=>n.handleUploadData&&n.handleUploadData(...t),["prevent"])),method:"post"},[e("div",Se,[a.uploadProgress<1?(l(),o("div",Te,[Ce,e("input",{type:"file",class:B(["form-control",{"is-invalid":(k=(f=a.errorMessage)==null?void 0:f.messages)==null?void 0:k.file}]),onChange:i[5]||(i[5]=(...t)=>n.uploadExcelData&&n.uploadExcelData(...t)),disabled:a.isDisabled},null,42,Ue),(D=(y=a.errorMessage)==null?void 0:y.messages)!=null&&D.file?(l(!0),o(m,{key:0},g((M=(v=a.errorMessage)==null?void 0:v.messages)==null?void 0:M.file,(t,d)=>(l(),o("div",{class:"invalid-feedback",key:d},x(t),1))),128)):r("",!0)])):(l(),o("div",He,[e("div",{class:"progress-bar progress-bar-striped progress-bar-animated",role:"progressbar","aria-valuenow":a.uploadProgress,"aria-valuemin":"0","aria-valuemax":"100",style:K({width:a.uploadProgress+"%"})}," Harap Tunggu! ",12,Ne)]))]),e("div",Fe,[Ee,e("div",null,[e("button",{type:"button",class:"btn btn-secondary me-2","data-bs-dismiss":"modal",disabled:a.isDisabled}," Batal ",8,We),a.isDisabled?r("",!0):(l(),o("button",Ie," Kirim ")),a.isDisabled?(l(),o("button",Ve,[je,h(" Harap Tunggu... ")])):r("",!0)])])],32)])])]),u(U,{url:{name:"User Member"},msg:a.msg},null,8,["msg"]),u(H,{onOnDelete:n.onDelete,msg:a.msg},null,8,["onOnDelete","msg"])],64)}const Xe=F(Q,[["render",Be]]);export{Xe as default};
